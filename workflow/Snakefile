configfile: "config/config.yaml"

FORMAT = config['FORMAT']

def get_input_fastqs(wildcards):
    return config["sample"][wildcard.sample]


if FORMAT == 'PE':
    rule preprocess:
        input:
            get_input_fastqs
        output:
            "results/fastq_cut/{sample}.t.r1.fastq"
            "results/fastq_cut/{sample}.t.r2.fastq"
        log:
            "logs/preprocess/{sample}.log"
        threads: 20
        shell:
            "workflow/scripts/preprocess_all.sh {config[cpus]} {wildcards.sample} {input} {config[FORMAT]} {output}"
else:
    rule preprocess:
        input:
            get_input_fastqs
        output:
            "results/fastq_cut/{sample}.t.fastq"
        log:
            "logs/sort_filter/{sample}.log"
        threads: 20
        shell:
            "workflow/scripts/preprocess_all.sh {config[cpus]} {wildcards.sample} {input} {config[FORMAT]} {output}"
